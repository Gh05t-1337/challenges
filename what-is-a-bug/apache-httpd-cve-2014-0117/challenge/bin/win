#!/bin/bash
set -euo pipefail
LOG=/opt/httpd/logs/error_log
if [ ! -f "$LOG" ]; then
  echo "No Apache error_log found yet."
  exit 1
fi

if grep -Eiq 'Memory allocation failed|exit signal (Segmentation fault|Aborted)|child .* exit signal' "$LOG"; then
  cat /flag || { echo "Flag not available"; exit 1; }
  exit 0
fi

echo "Crash not detected yet. Keep trying!"
exit 1
